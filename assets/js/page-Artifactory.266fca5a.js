(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{555:function(s,a,t){s.exports=t.p+"assets/img/Artifactory_1.0231d2ed.png"},556:function(s,a,t){s.exports=t.p+"assets/img/Artifactory_2.ffbacbca.png"},643:function(s,a,t){"use strict";t.r(a);var e=t(1),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"artifactory"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#artifactory"}},[s._v("#")]),s._v(" Artifactory")]),s._v(" "),e("p",[s._v("：一个 Web 服务器，提供了多种格式的工件仓库。")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://www.jfrog.com/confluence/display/RTF6X",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),e("OutboundLink")],1)]),s._v(" "),e("li",[s._v("采用 Java 开发，由美国 Jfrog 公司发布。\n"),e("ul",[e("li",[s._v("分为社区版（OSS）、专业版（PRO）。")]),s._v(" "),e("li",[s._v("OSS 版只支持创建少数几种仓库。")])])]),s._v(" "),e("li",[s._v("特点：\n"),e("ul",[e("li",[s._v("可以通过浏览器访问，也可以生成文件的 URL ，通过 HTTP API 上传、下载文件。")])])]),s._v(" "),e("li",[s._v("同类产品：\n"),e("ul",[e("li",[s._v("Nexus ：功能类似，属于竞品。支持多种格式的文件存储，不支持修改文件名、移动文件。")]),s._v(" "),e("li",[s._v("FTP 服务器：只支持二进制格式的文件存储，而且 FTP 协议比 HTTP 协议的通用性低。")]),s._v(" "),e("li",[s._v("Nextcloud ：网盘，只支持二进制格式的文件存储，而且访问时需要使用浏览器或专用客户端。")])])])]),s._v(" "),e("h2",{attrs:{id:"部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#部署"}},[s._v("#")]),s._v(" 部署")]),s._v(" "),e("ul",[e("li",[s._v("用 docker-compose 部署："),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("artifactory")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" artifactory\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" docker.bintray.io/jfrog/artifactory"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("oss"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("7.18.6\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" unless"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("stopped\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("JAVA_OPTS")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Duser.timezone=GMT+08\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 8082"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8082")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ./data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/var/opt/jfrog/artifactory\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("ul",[e("li",[s._v("需要调整挂载目录的权限："),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1030")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[s._v("默认用户名、密码为 admin、password 。")])])])]),s._v(" "),e("h2",{attrs:{id:"用法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#用法"}},[s._v("#")]),s._v(" 用法")]),s._v(" "),e("h3",{attrs:{id:"web-ui"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#web-ui"}},[s._v("#")]),s._v(" Web UI")]),s._v(" "),e("p",[s._v("Web 页面示例：")]),s._v(" "),e("p",[e("img",{attrs:{src:t(555),alt:"",loading:"lazy"}})]),s._v(" "),e("ul",[e("li",[e("p",[s._v('在 Web 页面左侧，可选择一个仓库。点击右上角的 "Deploy" 就会弹出一个上传文件的窗口。')])]),s._v(" "),e("li",[e("p",[s._v("上传文件时，会根据文件名自动生成上传路径（Target Path）。")]),s._v(" "),e("ul",[e("li",[s._v("如果已存在该路径的文件，则会覆盖它。")]),s._v(" "),e("li",[s._v("可以主动设置上传路径，比如划分出子目录。")])])]),s._v(" "),e("li",[e("p",[s._v("每个文件有一个唯一的 URL ，可供用户上传、下载该文件。")]),s._v(" "),e("ul",[e("li",[s._v("文件的 URL 等于 "),e("code",[s._v("仓库 URL + 文件上传路径")]),s._v(" 。可以从网页上拷贝该 URL ，也可以自己拼凑出来。")])])]),s._v(" "),e("li",[e("p",[s._v("每个文件会显示其修改时间。")]),s._v(" "),e("ul",[e("li",[s._v("建议在 General Settings 页面设置 Date Format 为 "),e("code",[s._v("yyyy-MM-dd HH:mm:ss ZZ")]),s._v(" 。")])])]),s._v(" "),e("li",[e("p",[s._v("在浏览器上访问仓库或目录的 URL ，会以 HTML 基本视图显示文件列表。如下：")]),s._v(" "),e("p",[e("img",{attrs:{src:t(556),alt:"",loading:"lazy"}})])])]),s._v(" "),e("h3",{attrs:{id:"仓库"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#仓库"}},[s._v("#")]),s._v(" 仓库")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("管理员可以创建仓库（Repository），设置哪些用户有权向该仓库上传、下载文件。")])]),s._v(" "),e("li",[e("p",[s._v("仓库有多种存储类型：")]),s._v(" "),e("ul",[e("li",[s._v("本地仓库(Local)")]),s._v(" "),e("li",[s._v("远程仓库(Remote)：通过 URL 拉取其它仓库的内容，缓存到本地。")]),s._v(" "),e("li",[s._v("虚拟仓库(Virtual)")])])]),s._v(" "),e("li",[e("p",[s._v("根据存储的文件格式对仓库分类：")]),s._v(" "),e("ul",[e("li",[s._v("Generic ：按二进制格式保存文件。")]),s._v(" "),e("li",[s._v("Gradle")]),s._v(" "),e("li",[s._v("Maven")])])]),s._v(" "),e("li",[e("p",[s._v("节省存储空间的措施：")]),s._v(" "),e("ul",[e("li",[s._v('Maven、Gradle 等类型的仓库，可以设置 "Max Unique Snapshots" 参数，只保留每个工件版本最大的 n 个快照（SNAPSHOT）。')]),s._v(" "),e("li",[s._v("Artifactory Pro 版可以安装 artifactCleanup 插件，定时删除本地仓库中未使用的文件。")]),s._v(" "),e("li",[s._v('Remote 类型的仓库可以设置 "Unused Artifacts Cleanup Period" 参数，将 n 小时未使用的缓存标记为 Unused 。然后在高级设置 Advanced -> Maintenance 页面，设置定时执行 "Cleanup Unused Cached Artifacts" 。')]),s._v(" "),e("li",[s._v("默认启用了 Backup 任务，每日备份所有数据库，可在设置页面取消。")])])])]),s._v(" "),e("h3",{attrs:{id:"访问控制"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#访问控制"}},[s._v("#")]),s._v(" 访问控制")]),s._v(" "),e("ul",[e("li",[s._v("采用基于角色的访问控制。")]),s._v(" "),e("li",[s._v("默认定义了一个匿名用户（anonymous），代表没有登录的用户。\n"),e("ul",[e("li",[s._v('可以在 Security -> Settings 页面中允许 "Allow Anonymous Access" 。')])])])]),s._v(" "),e("h3",{attrs:{id:"restful-api"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#restful-api"}},[s._v("#")]),s._v(" Restful API")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("上传文件：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -u 用户名:密码 "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://10.0.0.1:8082/artifactory/anonymous/test/1.zip'")]),s._v(" -T "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".zip "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /dev/null\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("下载文件：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -O -u 用户名:密码 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("URL"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("删除文件：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -X DELETE -u 用户名:密码 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("URL"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])])])}),[],!1,null,null,null);a.default=n.exports}}]);