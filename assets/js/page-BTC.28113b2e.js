(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{559:function(t,s){t.exports="data:image/jpeg;base64,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"},704:function(t,s,a){"use strict";a.r(s);var n=a(1),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"btc"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#btc"}},[t._v("#")]),t._v(" BTC")]),t._v(" "),n("p",[t._v("：比特币（Bitcoin），一种数字货币，由 BTC 区块链发行。")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://developer.bitcoin.org/devguide/index.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),n("OutboundLink")],1)])]),t._v(" "),n("h2",{attrs:{id:"架构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#架构"}},[t._v("#")]),t._v(" 架构")]),t._v(" "),n("ul",[n("li",[t._v("一些主机根据 BTC 协议相互通信，组成了 BTC 网络。这些主机称为 BTC 节点。")]),t._v(" "),n("li",[t._v("在区块链中存储所有交易信息。\n"),n("ul",[n("li",[t._v("每个节点上会存储一个区块链的完整副本。")]),t._v(" "),n("li",[t._v("一些节点会收集网络上广播的交易，打包写入最新的一个区块，然后将新区块广播给其它节点。")]),t._v(" "),n("li",[t._v("基于 PoW 共识算法决定哪个节点有权生成最新的一个区块。")])])]),t._v(" "),n("li",[t._v("用户可以运行专门的程序，作为节点，接入 BTC 网络。然后下载区块链，查询历史交易，或者广播新交易。")])]),t._v(" "),n("h2",{attrs:{id:"区块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#区块"}},[t._v("#")]),t._v(" 区块")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("如下图，一条区块链由多个区块串联组成，后一个区块会记录前一个区块的哈希值，构成哈希链。\n"),n("img",{attrs:{src:a(559),alt:"",loading:"lazy"}})]),t._v(" "),n("ul",[n("li",[t._v("哈希运算时采用 SHA256 算法。")]),t._v(" "),n("li",[t._v("存储字节流时采用小端序。")]),t._v(" "),n("li",[t._v("每个区块最多允许包含 1MB 的数据，超过则视作无效区块。")]),t._v(" "),n("li",[t._v("区块高度（Height）：从最早一个区块往后数，给各个区块分配一个从 0 开始递增的编号，用于索引。")]),t._v(" "),n("li",[t._v("区块深度（Depth）：从最新一个区块往前数，给各个区块分配一个从 1 开始递增的编号。\n"),n("ul",[n("li",[t._v("假设区块链的总高度为 H ，则对于高度为 h 的区块，其深度为 H-h+1 。")])])])])]),t._v(" "),n("li",[n("p",[t._v("一个区块的数据结构分为两部分：")]),t._v(" "),n("ul",[n("li",[t._v("header ：用于存储该区块的元数据。")]),t._v(" "),n("li",[t._v("body ：用于存储交易信息。")])])]),t._v(" "),n("li",[n("p",[t._v("区块 header 的长度固定为 80 bytes ，按顺序记录以下信息：")]),t._v(" "),n("ul",[n("li",[t._v("nVersion\n"),n("ul",[n("li",[t._v("：区块链协议的版本。")]),t._v(" "),n("li",[t._v("4 bytes ，int32_t 。")])])]),t._v(" "),n("li",[t._v("previous block header hash\n"),n("ul",[n("li",[t._v("：上一个区块的 header 的哈希值。用于确保它们不会被篡改。")]),t._v(" "),n("li",[t._v("32 bytes ，char[32] 。")])])]),t._v(" "),n("li",[t._v("merkle root hash\n"),n("ul",[n("li",[t._v("：当前区块 body 中所有交易信息的 Merkle Tree 的根哈希。用于确保它们不会被篡改。")]),t._v(" "),n("li",[t._v("32 bytes ，char[32] 。")])])]),t._v(" "),n("li",[t._v("timestamp\n"),n("ul",[n("li",[t._v("：矿工打包当前区块时的 Unix time 时间戳。必须大于前 11 个区块的平均时间戳、不大于当前实际时间 +2 小时。")]),t._v(" "),n("li",[t._v("4 bytes ，uint32_t 。")])])]),t._v(" "),n("li",[t._v("nBits（target threshold）\n"),n("ul",[n("li",[t._v("：nonce 的目标阈值。")]),t._v(" "),n("li",[t._v("4 bytes ，uint32_t 。")])])]),t._v(" "),n("li",[t._v("nonce\n"),n("ul",[n("li",[t._v("：一个随机数。")]),t._v(" "),n("li",[t._v("4 bytes ，uint32_t 。")])])])])])]),t._v(" "),n("h2",{attrs:{id:"账户"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#账户"}},[t._v("#")]),t._v(" 账户")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("BTC 协议中，用户可以根据 ECDSA 算法随机生成一对私钥、公钥，代表一个 BTC 账户，相当于一个银行账户的密码、账户名。")]),t._v(" "),n("ul",[n("li",[t._v("示例："),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("0xL3HpQs5M7tZLN1m6zmJ9YSPuFzA4gJDJy8Ru2hd5nAwcZC4tPm1T  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 私钥")]),t._v("\n0x1N8nCD314Z87BgYsK1y3vwRpAk8S1qbRcg                    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 公钥")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br")])]),n("ul",[n("li",[t._v("前缀 0x 表示十六进制。")]),t._v(" "),n("li",[t._v("私钥需要保密，而公钥公开给其他人。")])])]),t._v(" "),n("li",[t._v("BTC 采用椭圆曲线数字签名算法（ECDSA）生成数字签名，其中采用的椭圆曲线为 secp256k1 。\n"),n("ul",[n("li",[t._v("用户可以编写一个消息，将消息的哈希值用私钥加密之后公布，称为数字签名。其他人可使用对应的公钥解读数字签名，从而验证该消息的内容没有被篡改，并且是由该公钥对应的私钥签署的。")])])]),t._v(" "),n("li",[t._v("BTC 协议中，账户之间可以直接转账交易，只需用账户私钥生成交易的数字签名，相当于盖章授权。\n"),n("ul",[n("li",[t._v("不需要经过银行等第三方平台中转，实现了去中心化交易。")])])]),t._v(" "),n("li",[t._v("虚荣地址（Vanity Addresses）：虽然 BTC 私钥、公钥是随机的，但用户可以尝试生成大量私钥、公钥，直到公钥中包含有意义的单词，比如 ILoveU 。")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://www.bitaddress.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("bitaddress"),n("OutboundLink")],1),t._v(" ：一个网站，用于随机生成 BTC 账户，支持离线使用。")])])]),t._v(" "),n("li",[n("p",[t._v("生成一对私钥、公钥的步骤：")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("用户生成一个很大的随机整数，作为私钥（private key）。")]),t._v(" "),n("ul",[n("li",[t._v("私钥的长度为 256 bits = 32 bytes  。通常经过 Base58Check 编码，表示成 52 位长度的十六进制数。")]),t._v(" "),n("li",[t._v("用户选择私钥时应该尽量随机，避免与其他人相同。")])])]),t._v(" "),n("li",[n("p",[t._v("根据 ECDSA 算法，计算出私钥在椭圆曲线上对应的一个点，其坐标 x、y 作为公钥。")]),t._v(" "),n("ul",[n("li",[t._v("通过私钥可以计算出对应的公钥，但不能通过公钥反推出私钥。而且值域庞大，使得穷举几乎不可能。")]),t._v(" "),n("li",[t._v("未压缩公钥（uncompressed）：由坐标 x、y 的值组成，并加上前缀 0x04 作为标识，总长度为 1+32+32 = 65 bytes 。")]),t._v(" "),n("li",[t._v("压缩公钥（compressed）：由坐标 x 的值组成，并加上前缀 0x02 或 0x03 表示坐标 y 为偶数或奇数，总长度为 33 bytes 。\n"),n("ul",[n("li",[t._v("椭圆曲线关于 x 轴对称，一个坐标 x 对应两个 y 点。且在 secp256k1 曲线中，这两个 y 点分别为偶数、奇数，因此需要通过前缀区分。")]),t._v(" "),n("li",[t._v("使用压缩公钥时，需要给私钥加上后缀 0x01 作为标识，其长度增加 1 字节。")]),t._v(" "),n("li",[t._v("压缩格式的公钥、私钥更方便记录，是用户通常看到的格式，也是一般钱包采用的导入格式（Wallet Import Format，WIF）。")]),t._v(" "),n("li",[t._v("钱包软件在实际使用公钥时，会从压缩格式转换成非压缩格式。")])])])])]),t._v(" "),n("li",[n("p",[t._v("计算压缩公钥的 SHA256 哈希值，再计算其结果的 RIPEMD-160 哈希值。")])]),t._v(" "),n("li",[n("p",[t._v("将公钥哈希值（public key hash）经过 Base58Check 编码，表示成 34 位长度的十六进制数，称为账户地址（address）。")])])])]),t._v(" "),n("li",[n("p",[t._v("Base58Check 编码是为了将数据表示成更短的值，并加上校验码，并不会加密原数据。过程如下：")]),t._v(" "),n("ol",[n("li",[t._v("输入原数据 payload 。")]),t._v(" "),n("li",[t._v("在 payload 之前加上 1 字节的地址版本号 version 。")]),t._v(" "),n("li",[t._v("对 version、payload 串联成一个字符串，计算两次哈希值，取结果开头的 4 字节作为校验码 checksum 。\n"),n("ul",[n("li",[t._v("如果网络传输之后，再次计算两次哈希值，发现结果开头与校验码不一致，则说明编码值出错。")])])]),t._v(" "),n("li",[t._v("将 version、payload、checksum 串联成一个字符串，进行 base58 编码。\n"),n("ul",[n("li",[t._v("与 base64 相比，base58 的特点：\n"),n("ul",[n("li",[t._v("移除了 "),n("code",[t._v("+/")]),t._v(" 两个特殊字符，只允许使用大小写字母、数字。")]),t._v(" "),n("li",[t._v("移除了 "),n("code",[t._v("0OIi")]),t._v(" 四个容易混淆的字母。")])])]),t._v(" "),n("li",[t._v("P2PKH 地址的 version 为 0x00 ，因此编码之后，开头为 1 。")]),t._v(" "),n("li",[t._v("P2SH 地址的 version 为 0x05 ，因此编码之后，开头为 3 。")]),t._v(" "),n("li",[t._v("BTC 私钥的 version 为 0x80 ，因此编码之后，未压缩格式的开头为 5 ，压缩格式的开头为 K 或 L 。")])])])])])]),t._v(" "),n("h2",{attrs:{id:"交易"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#交易"}},[t._v("#")]),t._v(" 交易")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("一个交易（transaction）记录成特定格式的数据，像账本中的一条记录，主要包含以下信息：")]),t._v(" "),n("ul",[n("li",[t._v("version ：交易格式的版本号，占 4 bytes 。")]),t._v(" "),n("li",[t._v("in-counter ：表示输入项的数量。")]),t._v(" "),n("li",[t._v("inputs ：包含 n≥1 个输入项。\n"),n("ul",[n("li",[t._v("每个输入项的主要内容：\n"),n("ul",[n("li",[t._v("index ：输入项在 inputs 中的序号，从 0 开始递增。")]),t._v(" "),n("li",[t._v("previous txid ：引用一个历史交易，表示将该交易的 UTXO 全部输入当前交易。")]),t._v(" "),n("li",[t._v("sigScript")])])])])]),t._v(" "),n("li",[t._v("out-counter ：表示输出项的数量。")]),t._v(" "),n("li",[t._v("outputs ：包含 n≥1 个输出项。\n"),n("ul",[n("li",[t._v("每个输出项的主要内容：\n"),n("ul",[n("li",[t._v("index")]),t._v(" "),n("li",[t._v("value ：输出的 BTC 数量。")]),t._v(" "),n("li",[t._v("pkScript")])])]),t._v(" "),n("li",[t._v("一个交易的总输入减去总输出的差值，会被矿工当作交易费拿走，即 "),n("code",[t._v("fee = sum(inputs) – sum(outputs)")]),t._v(" 。")])])]),t._v(" "),n("li",[t._v("locktime ：表示允许将该交易打包到区块中的最早时间，占 4 bytes 。\n"),n("ul",[n("li",[t._v("如果取值小于 5 亿，则视作区块高度。")]),t._v(" "),n("li",[t._v("如果取值大于 5 亿，则视作 Unix 时间戳。")]),t._v(" "),n("li",[t._v("交易通常将 locktime 设置为 0x00000000 ，表示不限制。")])])])])]),t._v(" "),n("li",[n("p",[t._v("区块 body 中可以记录 n≥1 个交易，最大数量取决于区块的容量限制。")]),t._v(" "),n("ul",[n("li",[t._v("记录的第一个交易必须是 coinbase 交易。\n"),n("ul",[n("li",[t._v("coinbase 交易不存在输入，凭空产生一定量可以输出的 BTC ，作为打包该区块的网络节点的激励。")])])]),t._v(" "),n("li",[t._v("coinbase 交易之后可以记录 m≥0 个普通交易。\n"),n("ul",[n("li",[t._v("通常采用交易的哈希值作为其标识符，称为 txid 。")]),t._v(" "),n("li",[t._v("BTC 交易时，最小的单位为聪（satoshis），1 BTC = 10^8 聪。")])])]),t._v(" "),n("li",[t._v("一个交易数据的体积没有上限，只受到区块的容量限制。\n"),n("ul",[n("li",[t._v("增加交易体积时，通常需要增加交易费，吸引矿工打包该交易。")]),t._v(" "),n("li",[t._v("通常以 satoshi/Byte 为单位计算平均的交易费。")])])])])])]),t._v(" "),n("h3",{attrs:{id:"发起交易"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#发起交易"}},[t._v("#")]),t._v(" 发起交易")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("如果一个账户拥有一些 BTC ，则可以发起一个交易，输入一些 BTC ，然后输出给其它账户。")]),t._v(" "),n("ul",[n("li",[t._v("所有账户收到的 BTC ，都来自历史交易的输出，且源头都是 coinbase 交易。")]),t._v(" "),n("li",[t._v("如果一个交易输出的 BTC ，尚未被目标账户花费，则称为未花费交易输出（Unspent TX Output，UTXO）。\n"),n("ul",[n("li",[t._v("一个账户拥有的所有 UTXO 总和，称为该账户的余额。")]),t._v(" "),n("li",[t._v("一个交易的 UTXO 要么不被花费，要么被一次性全部花费，不能拆开花费。\n"),n("ul",[n("li",[t._v("例如 UTXO 为 5 BTC 时，用户可以新建一个交易，发送 1 BTC 给别人，然后将剩下的 BTC 发送给自己，从而实现找零。")])])])])]),t._v(" "),n("li",[t._v("统计 BTC 区块链上所有交易的输入、输出，筛选出所有 UTXO ，保存为一个数据库，就可以知道所有账户的余额。\n"),n("ul",[n("li",[t._v("BTC 协议并没有直接提供 UTXO 数据库，但一些区块链浏览器提供了这种查询功能。")])])])])]),t._v(" "),n("li",[n("p",[t._v("用户发起一个交易的步骤：")]),t._v(" "),n("ol",[n("li",[t._v("编写一个交易。\n"),n("ul",[n("li",[t._v("此时需要连接到 BTC 网络，获取最新的区块链数据，从中查询账户的历史交易，选择将哪些交易的 UTXO 作为当前交易的输入。")])])]),t._v(" "),n("li",[t._v("生成交易的 sigScript ，存放在交易的 inputs 中。")]),t._v(" "),n("li",[t._v("将交易广播到 BTC 网络上，等待矿工将它打包入新区块。")])])]),t._v(" "),n("li",[n("p",[t._v("用户广播一个交易之后，需要等待矿工将它写入区块，才算交易成功。分为多个阶段：")]),t._v(" "),n("ul",[n("li",[t._v("0 次确认\n"),n("ul",[n("li",[t._v("：交易还没有被写入区块。")])])]),t._v(" "),n("li",[t._v("1 次确认\n"),n("ul",[n("li",[t._v("：交易被写入最新的一个区块。")]),t._v(" "),n("li",[t._v("但可能有多个矿工同时打包出不同的最新区块，需要等待哪个最新区块最终被大部分矿工承认，因此交易还不算持久保存到区块链。")])])]),t._v(" "),n("li",[t._v("2 次确认\n"),n("ul",[n("li",[t._v("：交易被写入一个区块，该区块的深度为 2 。")]),t._v(" "),n("li",[t._v("BTC 网络中，篡改最近的两个区块需要超过 50% 的哈希算力，成本很大，因此一般可靠。")])])]),t._v(" "),n("li",[t._v("6 次确认\n"),n("ul",[n("li",[t._v("：交易被写入一个区块，该区块的深度为 6 ，几乎不可能被篡改。")]),t._v(" "),n("li",[t._v("由于 BTC 平均每隔 10 分钟生成一个区块，6 次确认需要等待 60 分钟。")])])])])]),t._v(" "),n("li",[n("p",[t._v("双花：一种攻击方式，指将同一个 UTXO 花费多次。")]),t._v(" "),n("ul",[n("li",[t._v("攻击方式举例：\n"),n("ul",[n("li",[t._v("一个不诚实的用户，同时广播多个交易，重复花费同一个 UTXO 。此时，诚实的矿工只会将其中一个交易写入新区块，将之后的交易视作无效。因此双花攻击无效。")]),t._v(" "),n("li",[t._v("一个不诚实的矿工，明知当前区块链高度为 N ，但依然从高度 N-i 处重新生成一条区块链，从而重写最近 i 个历史区块中的交易。"),n("br"),t._v("\n此时网络上同时存在新链和原链。根据 BTC 协议，所有矿工应该在最长的那条区块链上工作。不诚实的矿工需要掌握全网哈希算力的 50% 以上，使得新链生成新区块的速度比原链更快，在一段时间之后长度超越原链。"),n("br"),t._v("\n因此这种双花攻击几乎不可能，需要消耗大量哈希算力和时间成本。")])])])])])]),t._v(" "),n("h3",{attrs:{id:"pkscript"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#pkscript"}},[t._v("#")]),t._v(" pkScript")]),t._v(" "),n("p",[t._v("：公钥脚本（Pubkey Script，pkScript），采用一种专用的脚本语言编写，包含一些指令。")]),t._v(" "),n("ul",[n("li",[t._v("该脚本语言的特点：\n"),n("ul",[n("li",[t._v("基于堆栈。")]),t._v(" "),n("li",[t._v("非图灵完备，不支持循环。因此不能实现复杂的逻辑，但减少了出错的可能性。")])])]),t._v(" "),n("li",[t._v("pkScript 可以声明一些条件，当 sigScript 满足条件时才能花费其 UTXO 。\n"),n("ul",[n("li",[t._v("例如 P2PKH 的条件通常是：输出 n 个 BTC ，并指定一个公钥。只有拥有该公钥对应私钥的人，才有权花费该 UTXO 。")])])]),t._v(" "),n("li",[t._v("pkScript 又称为锁定脚本（locking script），因为它输出的 BTC 一直不可用，直到有人提供满足条件的 sigScript ，又称为解锁脚本。")])]),t._v(" "),n("p",[t._v("pkScript 有多种类型：")]),t._v(" "),n("ul",[n("li",[t._v("Pay To Pubkey（P2PK）\n"),n("ul",[n("li",[t._v("：将 BTC 转账给公钥。")])])]),t._v(" "),n("li",[t._v("Pay To Public Key Hash（P2PKH）\n"),n("ul",[n("li",[t._v("：将 BTC 转账给公钥哈希。")]),t._v(" "),n("li",[t._v("P2PK 常用于 BTC 早期的交易，后来被 P2PKH 取代。主要原因：\n"),n("ul",[n("li",[t._v("P2PKH 地址更短。")]),t._v(" "),n("li",[t._v("转账给 P2PKH 地址时，采用公钥哈希，隐藏了公钥，提供了额外的安全性。直到用户花费该账户时，才会公开公钥。")])])])])]),t._v(" "),n("li",[t._v("Pay To Script Hash（P2SH）\n"),n("ul",[n("li",[t._v("：将 BTC 转账给脚本哈希。\n"),n("ul",[n("li",[t._v("如果其他人提供的 sigScript 中，包含与 P2SH 哈希一致的脚本，称为赎回脚本（redeem script），则有权花费该 UTXO 。")])])]),t._v(" "),n("li",[t._v("基于赎回脚本可实现复杂的功能，例如多重签名、SegWit 兼容地址。")])])]),t._v(" "),n("li",[t._v("Pay to Witness Pubkey Hash（P2WPKH）\n"),n("ul",[n("li",[t._v("：与 P2PKH 类似，但启用了 SegWit 。")])])]),t._v(" "),n("li",[t._v("Pay to Witness Script Hash（P2WSH）")]),t._v(" "),n("li",[t._v("Null Data（空数据）\n"),n("ul",[n("li",[t._v("：pkScript 的开头是一个操作符 OP_RETURN ，表示终止脚本执行。\n"),n("ul",[n("li",[t._v("OP_RETURN 之后可以添加任意内容的数据，反正不会被执行。")]),t._v(" "),n("li",[t._v("该交易的 UTXO 不能被花费。")])])]),t._v(" "),n("li",[t._v("BTC 区块链原本用于记录交易信息，但一些用户想用区块链记录自定义的数据，比如一段文字广告。\n"),n("ul",[n("li",[t._v("有的用户在 coinbase 交易的剩余位置记录自定义数据。")]),t._v(" "),n("li",[t._v("有的用户在普通交易的 pkScript 位置记录自定义数据，导致该交易被发送到无效地址，不能花费 UTXO 。")]),t._v(" "),n("li",[t._v("推荐用户使用 OP_RETURN 记录自定义数据，此时将 UTXO 设置为 0 ，只需支付交易费。")])])])])])]),t._v(" "),n("h3",{attrs:{id:"sigscript"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sigscript"}},[t._v("#")]),t._v(" sigScript")]),t._v(" "),n("p",[t._v("：签名脚本（Signature Script，sigScript）。")]),t._v(" "),n("ul",[n("li",[t._v("sigScript 包含以下内容：\n"),n("ul",[n("li",[t._v("pubKey ：账户公钥。")]),t._v(" "),n("li",[t._v("sig ：交易数据的数字签名，使用账户私钥生成。")])])]),t._v(" "),n("li",[t._v("交易延展性（Transaction Malleability）攻击\n"),n("ul",[n("li",[t._v("：一种攻击方式，指改变未打包交易中的签名，使得整个交易的哈希值改变，导致引用该交易 txid 的其它交易失效。\n"),n("ul",[n("li",[t._v("由于椭圆曲线的对称性，可以计算出两个有效的签名，还可以根据其中一个签名推算出另一个签名。因此，可以替换交易中的签名。")])])]),t._v(" "),n("li",[t._v("常见的解决办法：\n"),n("ul",[n("li",[t._v("等待一个交易被打包，再引用它的 txid 。但这就不能实现闪电交易。")]),t._v(" "),n("li",[t._v("规定只采用取值较小的那个签名。")]),t._v(" "),n("li",[t._v("使用 SegWit 。")])])])])])]),t._v(" "),n("h3",{attrs:{id:"segwit"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#segwit"}},[t._v("#")]),t._v(" SegWit")]),t._v(" "),n("p",[t._v("：隔离见证，一种 BTC 的扩容方案，属于软分叉升级。")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("原理：给区块附加一个称为 witness 的结构，将交易中的见证数据（主要包含 sigScript ）移出，存放在 witness 区域。")]),t._v(" "),n("ul",[n("li",[t._v("这会减小交易的一大半体积，可以在区块中打包更多交易。")]),t._v(" "),n("li",[t._v("witness 区域的 tree 哈希记录在 coinbase 交易中，从而嵌入 Merkle Tree 。")]),t._v(" "),n("li",[t._v("此时的区块称为 SegWit 格式。基础容量（称为 size ）依然限制为 1MB ，附加 witness 数据时的总体积（称为 weight ）限制为 4MB 。")]),t._v(" "),n("li",[t._v("此时交易的哈希值称为 wtxid 。改变 sigScript 时，不会影响 wtxid ，避免了 Transaction Malleability 攻击。")])])]),t._v(" "),n("li",[n("p",[t._v("使用 SegWit 时，账户地址有两种格式：")]),t._v(" "),n("ul",[n("li",[t._v("原生地址（Native）：采用 Bech32 编码格式，只允许使用小写字母、数字，长度为 42 位，开头为 bc1 。")]),t._v(" "),n("li",[t._v("兼容地址（Nested）：采用 P2SH 地址，开头为 3 。\n"),n("ul",[n("li",[t._v("原生地址地址的效率比兼容地址更高。")]),t._v(" "),n("li",[t._v("传统地址（Legacy）不支持与 SegWit 原生地址转账。")]),t._v(" "),n("li",[t._v("SegWit 兼容地址支持与传统地址、SegWit 原生地址转账。")])])])])]),t._v(" "),n("li",[n("p",[t._v("SegWit 软分叉还涉及到 BTC 社区的治理问题，相关历史：")]),t._v(" "),n("ul",[n("li",[t._v("2015 年，Bitcoin Core 开发人员提出了 BIP141 ，提议 SegWit ，是此时 BTC 变动最大的一次软分叉升级。")]),t._v(" "),n("li",[t._v("2016 年，Bitcoin Core 按 BIP9 方式开始 SegWit 软分叉，但支持 SegWit 的矿工远未达到 95% 的激活阈值，主要原因：\n"),n("ul",[n("li",[t._v("SegWit 尚未推广，早期升级的收益较小。")]),t._v(" "),n("li",[t._v("旧区块可通过 AsicBoost 算法提高挖矿的哈希算力。")]),t._v(" "),n("li",[t._v("SegWit 增加了区块的复杂性，需要修改很多客户端代码，不如硬分叉简单。")])])]),t._v(" "),n("li",[t._v("2017 年 2 月，社区的开发人员提出了 BIP148 ，提议用户激活软分叉（User Activated Soft Fork，UASF），逼迫矿工激活 SegWit 。\n"),n("ul",[n("li",[t._v("BIP148 大意为：从 8 月开始，采用 BIP148 的节点会拒绝不支持 SegWit 的新区块，导致发生硬分叉。")]),t._v(" "),n("li",[t._v("BIP9 让矿工投票决定软分叉升级，而 UASF 使得用户也拥有了控制权。但这更像一个抗议行动，不支持的矿工只是少了打包这部分用户的交易费。")])])]),t._v(" "),n("li",[t._v("2017 年 4 月，Charlie Lee 与矿工协商之后，成功在 LTC 上激活 SegWit 。")]),t._v(" "),n("li",[t._v("2017 年 5 月，一些公司和矿池签署了纽约共识（New York Agreement，NYA），表示作为激活 SegWit 的交换，要求也激活 SegWit2x 。\n"),n("ul",[n("li",[t._v("原理：与 SegWit 不同，直接将区块的基础容量限制从 1MB 增加到 2MB ，属于硬分叉升级")]),t._v(" "),n("li",[t._v("SegWit2x 与 BCH 的区块扩容类似，受到 Bitcoin Core 开发人员的反对，最终在 11 月放弃了该提议。")])])]),t._v(" "),n("li",[t._v("2017 年 5 月，一个开发人员提出了 BIP91 ，使得 BIP148 与 SegWit2x 两派可以兼容，避免发生硬分叉。\n"),n("ul",[n("li",[t._v("BIP91 的内容与 BIP148 相似，但没有限制时间。")]),t._v(" "),n("li",[t._v("BIP91 部署之后，激活它的阈值为 80% 。当 BIP141 被激活或失败时，BIP91 就会停止。")])])]),t._v(" "),n("li",[t._v("2017 年 7 月，市场担心 BIP148 硬分叉的风险，BTC 价格从 $2700 跌到 $2000 ，促使矿工们支持 BIP91 并激活它。")]),t._v(" "),n("li",[t._v("2017 年 8 月，SegWit2x 终于激活。\n"),n("ul",[n("li",[t._v("此时，大部分矿工、钱包软件依然没有升级 SegWit 。但是采用 SegWit 原生地址的用户越来越多，为了服务这部分用户，矿工、钱包软件会逐渐升级 SegWit 。")])])])])])]),t._v(" "),n("h2",{attrs:{id:"合约交易"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#合约交易"}},[t._v("#")]),t._v(" 合约交易")]),t._v(" "),n("p",[t._v("基于 P2SH 脚本可实现一些合约交易，提供多种功能。")]),t._v(" "),n("h3",{attrs:{id:"多重签名"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#多重签名"}},[t._v("#")]),t._v(" 多重签名")]),t._v(" "),n("p",[t._v("：多重签名（multi-signature，multisig），一种基于 P2SH 的交易方式。")]),t._v(" "),n("ul",[n("li",[t._v("原理：将 BTC 转账到一个 P2SH 地址，通过 pkScript 指定 n 个公钥，要求 sigscript 至少用 m 个对应的私钥签名才有效。\n"),n("ul",[n("li",[t._v("其中 1≤m≤n≤15 ，又称为 m-of-n 交易。")])])]),t._v(" "),n("li",[t._v("1of2 是允许两个账户中的任意一个都有权花费 UTXO 。")]),t._v(" "),n("li",[t._v("2of3 适合三方交易。例如 A 想花费 BTC 从 B 处购买商品，先将 BTC 转账到 2of3 多签地址。\n"),n("ul",[n("li",[t._v("如果仲裁方判断交易成功，则与 B 一起签名，将 BTC 转账给 B 。")]),t._v(" "),n("li",[t._v("如果仲裁方判断交易失败，则与 A 一起签名，将 BTC 转账给 A 。")]),t._v(" "),n("li",[t._v("没有 A 或 B 的同意，仲裁方不能私自转走 BTC 。")])])])]),t._v(" "),n("h3",{attrs:{id:"闪电交易"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#闪电交易"}},[t._v("#")]),t._v(" 闪电交易")]),t._v(" "),n("p",[t._v("：闪电交易（Lightning Network，LN），一种 layer2 技术，基于链下交易（Off-Chain）。")]),t._v(" "),n("ul",[n("li",[n("p",[n("a",{attrs:{href:"https://github.com/lightning/bolts",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub"),n("OutboundLink")],1)])]),t._v(" "),n("li",[n("p",[t._v("原理：在区块链下进行任意数量的交易，然后将这些交易的结果保存到区块链。主要步骤如下：")]),t._v(" "),n("ol",[n("li",[t._v("开启通道：两个账号将一笔 BTC 转账到一个多签地址，暂时锁定，称为开启一个闪电交易通道（channel）。")]),t._v(" "),n("li",[t._v("使用通道：双方建立对等连接（Peer connection），私下进行一些交易。")]),t._v(" "),n("li",[t._v("关闭通道：双方根据交易结果，将多签地址的 BTC 分配给双方。")])])]),t._v(" "),n("li",[n("p",[t._v("在通道中，双方私下进行的交易只需要互相知道，不必公布到区块链上，称为承诺交易（commitment transaction）。")]),t._v(" "),n("ul",[n("li",[t._v("每个承诺交易，表示此时的通道状态，即双方应该分别拥有通道的多少 UTXO 。")]),t._v(" "),n("li",[t._v("每创建一个新的承诺交易，就撤销旧的承诺交易。\n"),n("ul",[n("li",[t._v("为此双方要交换一个承诺撤销密钥，证明它已撤销。")]),t._v(" "),n("li",[t._v("如果一方将已撤销的承诺交易广播到链上，企图双花攻击。则另一方可以根据撤销密钥，广播一个更新的惩罚交易（Penalty transaction），将通道的全部资产转给自己。")])])]),t._v(" "),n("li",[t._v("每个承诺交易设置了 locktime ，如果某方离线，则另一方等待 locktime 时间之后就可以将承诺交易公布到链上，从而关闭通道。\n"),n("ul",[n("li",[t._v("每个承诺交易的 locktime 依次递减，因此越新的承诺交易能越早公布到链上。")]),t._v(" "),n("li",[t._v("准备关闭通道时，双方签署最后一笔承诺交易，立即公布到链上。")])])])])]),t._v(" "),n("li",[n("p",[t._v("闪电交易通道只能连通两个账户，但大量相互开启通道的账户可以组成闪电交易网络。")]),t._v(" "),n("ul",[n("li",[t._v("假设 A 与 B 之间存在通道，B 与 C 之间存在通道，则 A 可以通过 B 间接转账给 C 。此时 B 称为路由节点，像计算机网络的路由转发。")]),t._v(" "),n("li",[t._v("哈希时间锁定合约（Hash Time Locked Contracts，HTLC）：一种智能合约，用于保证路由节点的可信任。工作流程如下：\n"),n("ol",[n("li",[t._v("A 创建一个密钥 secret ，私下发送给 C 。")]),t._v(" "),n("li",[t._v("A 在 A、B 之间的通道，使用 secret 的哈希值签署一个 HTLC 合约，将 BTC 转入合约。合约大意为：如果 B 能在 locktime 时间内发现 secret ，则有权获得合约的 UTXO ，否则资金将返回给 A 。")]),t._v(" "),n("li",[t._v("B 在 B、C 之间的通道，也创建一个使用同样 secret 哈希值的 HTLC 合约，请求 C 提供 secret 。但是合约锁定的 UTXO 微少一点，因为 B 收取了交易费。locktime 也更短一点。")]),t._v(" "),n("li",[t._v("C 提供 secret ，完成 B 的 HTLC 合约，得到 UTXO 。然后 B 再提供 secret ，完成 A 的 HTLC 合约。\n"),n("ul",[n("li",[t._v("即使 B 下线，C 依然可以完成 B 的 HTLC 合约，只有 B 会受到损失。")])])])])]),t._v(" "),n("li",[t._v("一些大型的路由节点可连接大量用户，像中心化网络。")]),t._v(" "),n("li",[t._v("一些路由节点会担任瞭望塔（watchtower），监控网络，广播惩罚交易。")])])]),t._v(" "),n("li",[n("p",[t._v("优点：")]),t._v(" "),n("ul",[n("li",[t._v("能快速处理大量新交易。")]),t._v(" "),n("li",[t._v("交易费很低：支付给路由节点的费用很低，适合以 satoshis 为单位的小额交易。")]),t._v(" "),n("li",[t._v("耗时短：每个交易不超过一分钟，不需要等待区块链打包、确认。")]),t._v(" "),n("li",[t._v("隐私：只有开启通道、关闭通道的两次交易需要公布到链上，期间的交易不会上链，路由节点也不会知道整个交易的源头、终点。")]),t._v(" "),n("li",[t._v("通道中的交易不必打包到区块链，因此节省了区块空间，降低了区块链的负载。")])])]),t._v(" "),n("li",[n("p",[t._v("相关历史：")]),t._v(" "),n("ul",[n("li",[t._v("2017 年 5 月，LTC 区块链进行了第一次闪电交易。")]),t._v(" "),n("li",[t._v("2019 年 1 月，twitter 用户发起了一场称为闪电火炬（Lightning Torch）的行动，用于推广闪电交易。\n"),n("ul",[n("li",[t._v("规则：通过闪电交易发送一笔小额 BTC ，收到转账的账户添加 10w satoshis 之后再发送给下一个账户，以此类推。")]),t._v(" "),n("li",[t._v("这笔 BTC 传递了将近 300 次，最终被捐赠。")])])])])])]),t._v(" "),n("h3",{attrs:{id:"coinjoin"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#coinjoin"}},[t._v("#")]),t._v(" CoinJoin")]),t._v(" "),n("p",[t._v("：一种混币方案。")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("原理：n 个账户共同发起一笔 BTC 交易，分别输入 C 数量的 BTC ，然后分别输出 C 数量到 n 个账户。")]),t._v(" "),n("ul",[n("li",[t._v("如果输出账户与输入账户都是不同的地址，则难以确定它们之间的对应关系。")]),t._v(" "),n("li",[t._v("n 的数量越大，混淆度越高。")])])]),t._v(" "),n("li",[n("p",[t._v("假设用户 A 参与了一次 CoinJoin 混币，从自己的一个账户发送 BTC 到自己的另一个账户。")]),t._v(" "),n("ul",[n("li",[t._v("虽然混币交易是公开的，其他人知道了 A 参与了混币，但并不知道哪个输出账户是由 A 控制，任意一个输出账户是由 A 控制的概率为 1/n 。")]),t._v(" "),n("li",[t._v("因此即使输入账户暴露了现实身份，输出账户也重新得到了匿名性。")])])]),t._v(" "),n("li",[n("p",[t._v("BTC 账户具有匿名性，但账户的交易过程、余额都是公开的，难以保护隐私。")]),t._v(" "),n("ul",[n("li",[t._v("例如用户 A 使用一个 BTC 账户在网上购物，转账记录都是公开的，其他人可以知道他购买的所有商品，推测他的消费习惯、个人喜好。\n"),n("ul",[n("li",[t._v("如果购物时的 IP 地址、物流信息被泄露，账户就失去了匿名性。即使 A 将 BTC 转入其它账户，其他人也知道新账户的地址，推测新账户很可能属于他。")])])])])]),t._v(" "),n("li",[n("p",[t._v("混币（Coin Mixing）")]),t._v(" "),n("ul",[n("li",[t._v("：指混淆多个账户的交易过程，使得难以确定每个账户的收入来自哪个账户、支出去向哪个账户，只能知道每个账户收入、支出的数量以及余额。")]),t._v(" "),n("li",[t._v("常见的混币方案：\n"),n("ul",[n("li",[t._v("通过第三方平台转账：比如将币转入中心化交易所，再由从交易所转出到其它账户地址。但这样需要担心交易所的提现风险，而且交易所也能查出交易过程、记录 KYC 信息。")]),t._v(" "),n("li",[t._v("CoinJoin")])])]),t._v(" "),n("li",[t._v("闪电交易也加强了隐私，但并不属于混币，而是避免交易过程上链。")])])])]),t._v(" "),n("h2",{attrs:{id:"网络"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#网络"}},[t._v("#")]),t._v(" 网络")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("一些主机根据 BTC 协议相互通信，组成了 BTC 网络。这些主机称为 BTC 节点。")]),t._v(" "),n("ul",[n("li",[t._v("基于 TCP/IP 协议进行通信。")]),t._v(" "),n("li",[t._v("通信模式为点对点（P2P），即主机之间两两建立对等连接。\n"),n("ul",[n("li",[t._v("如果两个节点建立对等连接，则称为相邻节点。")]),t._v(" "),n("li",[t._v("一个节点可以将消息发送给所有相邻节点，后者再转发给它们的相邻节点，以此类推，就可以将该消息广播给网络的大部分节点。")])])]),t._v(" "),n("li",[t._v("通常人们使用的是 BTC 主网络，但还有测试网络等其它网络。每个网络中存在一条独立的区块链。")])])]),t._v(" "),n("li",[n("p",[t._v("节点分类：")]),t._v(" "),n("ul",[n("li",[t._v("全节点（Full Node）\n"),n("ul",[n("li",[t._v("：存储了 BTC 区块链的所有区块，是 BTC 网络的基础。")]),t._v(" "),n("li",[t._v("可以接收并验证网络上广播的交易、区块，如果有效则广播给其它节点。")]),t._v(" "),n("li",[t._v("允许其它节点连接到自己，从而下载区块链。")])])]),t._v(" "),n("li",[t._v("挖矿节点（Mining Node）\n"),n("ul",[n("li",[t._v("：属于全节点，但还会收集交易、打包新区块，即更新区块链。")])])]),t._v(" "),n("li",[t._v("轻节点（Lightweight Node）\n"),n("ul",[n("li",[t._v("：只存储所有区块的的 header ，需要读取区块内容时，再从全节点下载。\n"),n("ul",[n("li",[t._v("可根据自己存储的 header ，验证全节点提供的各个区块是否正确。")])])]),t._v(" "),n("li",[t._v("全节点能够独立验证一个交易、区块是否有效，而轻节点需要依赖全节点。")]),t._v(" "),n("li",[t._v("大部分的钱包软件属于轻节点，通过 SPV 验证指定账户的历史交易、UTXO 。\n"),n("ul",[n("li",[t._v("简单支付验证（Simplified Payment Verification，SPV）：普通节点连接到全节点，发送布隆过滤器（bloom filter），筛选出与指定账户相关的所有历史交易，然后下载这些交易。")])])])])])])]),t._v(" "),n("li",[n("p",[t._v("一个全节点的启动步骤：")]),t._v(" "),n("ol",[n("li",[t._v("与至少一个全节点建立对等连接，加入 BTC 网络。\n"),n("ul",[n("li",[t._v("通常在本机存储了一些全节点的 IP 地址，可在启动时快速连接它们。")]),t._v(" "),n("li",[t._v("可以发现并连接新的全节点。也可以广播自己的 IP 地址，供其它节点连接。")]),t._v(" "),n("li",[t._v("默认监听 TCP 8333 端口，供其它节点连接自己。也可以不监听，只允许自己主动连接其它节点。")])])]),t._v(" "),n("li",[t._v("从其它全节点下载区块数据，更新本机存储的区块链。\n"),n("ul",[n("li",[t._v("如果本机之前没有存储区块链，则需要从第一个区块开始下载并验证各个区块。")]),t._v(" "),n("li",[t._v("如果本机已经存储了旧的区块链，则只需下载并验证最新的一些区块。")])])]),t._v(" "),n("li",[t._v("保持运行，接收网络上广播的消息。例如：\n"),n("ul",[n("li",[t._v("接收新产生的区块，如果验证通过则存储到本机。")]),t._v(" "),n("li",[t._v("接收新的未打包交易，如果验证通过则广播给相邻节点。")])])])])]),t._v(" "),n("li",[n("p",[t._v("相关概念：")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://bitnodes.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("bitnodes"),n("OutboundLink")],1),t._v(" "),n("ul",[n("li",[t._v("：一个网站，统计了全球各地的 BTC 全节点的数量。")])])]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/bitcoin/bitcoin",target:"_blank",rel:"noopener noreferrer"}},[t._v("Bitcoin Core"),n("OutboundLink")],1),t._v(" "),n("ul",[n("li",[t._v("：一个 C++ 程序，实现了标准、完整的 BTC 协议，可用于运行一个全节点，还提供了挖矿、钱包的功能。\n"),n("ul",[n("li",[t._v("包含一个守护进程 bitcoind ，进行 RPC 通信。")]),t._v(" "),n("li",[t._v("包含一个命令行工具 bitcoin-cli ，供用户操作。")]),t._v(" "),n("li",[t._v("基于 Qt 提供了 GUI 界面，又称为 Bitcoin-Qt 。")])])]),t._v(" "),n("li",[t._v("最初由中本聪开发，后来作为一个开源项目托管在 GitHub 上。")])])]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/bitcoinj/bitcoinj",target:"_blank",rel:"noopener noreferrer"}},[t._v("bitcoinj"),n("OutboundLink")],1),t._v(" "),n("ul",[n("li",[t._v("：一个实现了 BTC 协议的 Java 库，可用于编写钱包软件。")])])])])])]),t._v(" "),n("h3",{attrs:{id:"共识"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#共识"}},[t._v("#")]),t._v(" 共识")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("所有 BTC 节点遵循一些相同的共识规则，比如如何验证一个交易、区块是否有效。")])]),t._v(" "),n("li",[n("p",[t._v("BTC 改进提案（Bitcoin Improvement Proposals，BIP）：BTC 社区通过提案来讨论一些改进方案。")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/bitcoin/bips",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub"),n("OutboundLink")],1)])])]),t._v(" "),n("li",[n("p",[t._v("实施一个新的共识规则时，根据兼容性，分为两种情况：")]),t._v(" "),n("ul",[n("li",[t._v("软分叉（Soft Fork）：新的共识规则向前兼容旧规则，因此旧节点依然接受新节点打包的区块。\n"),n("ul",[n("li",[t._v("但旧节点打包的区块，要符合新共识规则才会被新节点接受，否则网络分叉成两条区块链。")])])]),t._v(" "),n("li",[t._v("硬分叉（Hard Fork）：新的共识规则不向前兼容，因此旧节点不会接受新节点打包的区块，导致新、旧网络分叉成两条区块链。")])])]),t._v(" "),n("li",[n("p",[t._v("根据 BIP9 ，一个软分叉升级的流程如下：")]),t._v(" "),n("ol",[n("li",[t._v("将软分叉部署到网络上，进入 started 状态。")]),t._v(" "),n("li",[t._v("矿工们修改新区块的 nVersion 中的标志位，表示是否支持该软分叉。")]),t._v(" "),n("li",[t._v("如果在超时之前，该软分叉获得 95% 矿工（占全网哈希算力的比例）的支持，则锁定（lock_in）成为共识规则。然后在一段时间之后激活（activate），给其它节点留有准备时间。\n"),n("ul",[n("li",[t._v("如果超时，则部署失败，变为 failed 状态。")])])])])])]),t._v(" "),n("h2",{attrs:{id:"矿工"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#矿工"}},[t._v("#")]),t._v(" 矿工")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("打包新区块的节点，有权得到 coinbase 交易产生的 BTC 。因此该过程称为挖矿，运行挖矿节点的人们称为矿工（miner）。")])]),t._v(" "),n("li",[n("p",[t._v("矿工挖矿的流程：")]),t._v(" "),n("ol",[n("li",[t._v("接收网络上广播的多个交易，打包成一个候选区块。\n"),n("ul",[n("li",[t._v("为了收益，矿工会优先打包交易费高、体积小的交易。")]),t._v(" "),n("li",[t._v("矿工需要验证交易是否有效，比如 sigScript、locktime 。否则打包的区块不符合共识规则，不会被其他矿工承认。")])])]),t._v(" "),n("li",[t._v("尝试穷举区块的 nonce 值，直到满足挖矿难度，使得候选区块变成有效区块。\n"),n("ul",[n("li",[t._v("如果发现其他矿工抢先打包了新区块，则放弃打包当前区块，开始打包下一个区块。")])])])])]),t._v(" "),n("li",[n("p",[t._v("矿工打包一个新区块时，能得到两种收益：")]),t._v(" "),n("ul",[n("li",[t._v("coinbase 奖励\n"),n("ul",[n("li",[t._v("BTC 协议规定，BTC 币总量为 2100 万个。初期的每个区块 coinbase 会产生 50 个 BTC 。每隔 4 年，即大概 21 万个区块，新区块的产量减少一半。")]),t._v(" "),n("li",[t._v("因此 coinbase 奖励会越来越少，矿工越来越依赖交易费的收益。")])])]),t._v(" "),n("li",[t._v("区块内所有交易的交易费\n"),n("ul",[n("li",[t._v("假设 coinbase 奖励为 25 个 BTC ，总交易费为 0.1 个，则矿工可以编写 coinbase 交易，将 25.1 个发送到指定账户。")])])])])]),t._v(" "),n("li",[n("p",[t._v("矿工需要付出一定成本，主要是运行挖矿节点的设备费用、电费、网络费。")]),t._v(" "),n("ul",[n("li",[t._v("独自挖矿时，矿工自己算力占全网算力的比例，就是挖矿成功率，可能隔很多天才能挖矿成功。")]),t._v(" "),n("li",[t._v("早期的 BTC 主要采用 CPU 挖矿，后来过渡到效率更高的 GPU 挖矿，再后来过渡到专业矿机，采用特制的集成电路芯片（ASIC）。\n"),n("ul",[n("li",[t._v("目前的全文哈希算力极高，竞争极大，使用家用电脑独自挖矿的成功概率趋近于零。")])])])])]),t._v(" "),n("li",[n("p",[t._v("一些矿工会组成一个矿池，一起挖矿。然后根据贡献的算力，分配挖矿收益。")]),t._v(" "),n("ul",[n("li",[t._v("矿池下的矿工不需要作为节点加入 BTC 网络，而只需要连接到矿池服务器，执行运算、提交工作量证明。")]),t._v(" "),n("li",[t._v("与独自挖矿相比，矿池每天都能获得稳定收益。而且即使算力较低，也可以到矿池出售。")])])])]),t._v(" "),n("h3",{attrs:{id:"挖矿难度"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#挖矿难度"}},[t._v("#")]),t._v(" 挖矿难度")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("矿工打包新区块时，需要尝试指定 nonce 值，比如穷举。如果使得当前 header 的哈希值小于等于 target threshold ，则有权打包该区块，被其他矿工承认。")]),t._v(" "),n("ul",[n("li",[t._v("SHA256 哈希值的长度为 32 bytes ，而 target threshold 以有损压缩形式存储为 nBits ，长度为 4 bytes 。")]),t._v(" "),n("li",[t._v("例：根据 nBits 计算出 target threshold"),n("div",{staticClass:"language-py line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-py"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" nBits  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x170cfecf'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("                              "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 假设 nBits 的取值")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("256")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x17'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x0cfecf'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将第一个字节作为 256 的幂，再乘以后三个字节")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{:064x}"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("format")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x0000000000000000000cfecf0000000000000000000000000000000000000000'")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br")])]),n("ul",[n("li",[t._v("可见 nBits 第一个字节的值越大，会使 taget 越大，开头连续的 0 越少，因此挖矿难度越小。")])])])])]),t._v(" "),n("li",[n("p",[t._v("difficulty 表示挖矿难度。")]),t._v(" "),n("ul",[n("li",[t._v("计算公式如下："),n("div",{staticClass:"language-py line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-py"}},[n("code",[t._v("diffculty "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" difficulty_1_target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" target\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])]),n("ul",[n("li",[t._v("可见 difficulty 与 target 成反比，取值越小则挖矿难度越小，最小为 1 。")])])]),t._v(" "),n("li",[t._v("difficulty_1_target 表示区块链的初始难度，是一个常数："),n("div",{staticClass:"language-py line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-py"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" difficulty_1_target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("256")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{:064x}"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("format")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("difficulty_1_target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x00000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffff'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" difficulty_1_target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" target\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21659675333681.926")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br")])])]),t._v(" "),n("li",[t._v("当 difficulty 为 1 时，target 达到允许的最大值 0x1d00FFFF 。因为有损压缩丢失了右侧的所有 0xF ，所以有的程序会将 difficulty_1_target 计算成偏小的值："),n("div",{staticClass:"language-py line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-py"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" _target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("256")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x1d'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x00FFFF'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{:064x}"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("format")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x00000000ffff0000000000000000000000000000000000000000000000000000'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" _target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" target\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21659344833264.848")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br")])]),n("ul",[n("li",[t._v("丢失右侧 0xF 的 difficulty_1_target 常用于快速估算难度，称为 bdiff（Bitcoin difficulty）。")]),t._v(" "),n("li",[t._v("标准的 difficulty_1_target 常用于正式挖矿，称为 pdiff（Pool difficulty）。")])])]),t._v(" "),n("li",[t._v("例：根据 nBits 估算出 difficulty"),n("div",{staticClass:"language-py line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-py"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" nBits      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x170cfecf'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" difficulty "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("256")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("29")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nBits "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("65535.0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("float")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nBits "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0xFFFFFF")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" difficulty\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21659344833264.848")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br")])])]),t._v(" "),n("li",[t._v("BTC 预计每隔 10 分钟生成一个新区块。为了维持这一速率，所有节点会每隔 2016 个区块调整一次挖矿难度，重新计算 nBits ："),n("div",{staticClass:"language-py line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-py"}},[n("code",[t._v("expected_time  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 理论上最近 2016 个区块应该消耗 2016*10 分钟即 2 周")]),t._v("\nactual_time    "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 填入实际上最近 2016 个区块消耗的时长")]),t._v("\nnew_difficulty "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" old_difficulty "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" actual_time "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" expected_time "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nnew_nBits      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 根据 new_difficulty 算出 new_nBits")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br")])])])])]),t._v(" "),n("li",[n("p",[t._v("理论上，SHA256 哈希值有 2^256 种可能性，而 nonce 只有 2^32 种可能性，因此可能穷举 nonce 的所有值之后依然不满足 target threshold 。")]),t._v(" "),n("ul",[n("li",[t._v("例如 2020 年发布的蚂蚁矿机 S19 ，额定算力为 95 THash/s ，遍历 nonce 所有值的耗时不超过 1 秒："),n("div",{staticClass:"language-py line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-py"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("95")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.045")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br")])])]),t._v(" "),n("li",[t._v("当 nonce 被穷举完时，矿工通常会在 coinbase 交易中加入一个 4 bytes 的随机数，称为 extraNonce ，从而增加到 2^64 种可能性。")]),t._v(" "),n("li",[t._v("例如 2020 年 BTC 全网算力达到了 150 EHash/s = 150 * 10^3 PHash/s = 150 * 10^6 THash/s ，遍历 nonce + extraNonce 消耗的秒数为："),n("div",{staticClass:"language-py line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-py"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("round")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("150")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("123")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br")])]),t._v("因此挖矿难度自动上调得很大，从而限制产生新区块的耗时依然为 10 分钟。矿工需要增加 extraNonce 的位数到 8 bytes 。")])])])]),t._v(" "),n("h2",{attrs:{id:"相关历史"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#相关历史"}},[t._v("#")]),t._v(" 相关历史")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("2008 年，一个网名为 Satoshi Nakamoto（中本聪）的人发布了 "),n("a",{attrs:{href:"https://bitcoin.org/bitcoin.pdf",target:"_blank",rel:"noopener noreferrer"}},[t._v("比特币白皮书"),n("OutboundLink")],1),t._v(" ，设计了 BTC 的最初架构：")]),t._v(" "),n("ul",[n("li",[t._v("去中心化交易：属于点对点的交易系统。用户之间可以直接转账交易，不需要经过第三方机构中转、审批。")]),t._v(" "),n("li",[t._v("基于区块链，存储已发生的转账交易，防止被篡改。\n"),n("ul",[n("li",[t._v("所有交易是公开记录的，容易溯源。但账户地址是匿名的，不需绑定身份信息。")]),t._v(" "),n("li",[t._v("工作量证明（Proof-of-Work）：各节点都可以尝试开采新区块，但只有最先满足挖矿难度的节点有权开采新区块，并提交 nonce 作为哈希运算的工作量证明。")]),t._v(" "),n("li",[t._v("激励：成功创建新区块的节点，可以获得一定量的 BTC 。")]),t._v(" "),n("li",[t._v("如果同时存在多条区块链，则最长的那条拥有的工作量证明最多，被各节点接受。")])])])])]),t._v(" "),n("li",[n("p",[t._v("2009 年 1 月，中本聪生成了第一个 BTC 区块，称为创世区块（Genesis Block）。")]),t._v(" "),n("ul",[n("li",[t._v("中本聪在该区块的 coinbase 中记录了一个字符串，是泰晤士报的一个新闻标题："),n("code",[t._v("The Times 03/Jan/2009 Chancellor on brink of second bailout for banks.")]),t._v(" ，是指英国政府在 2008 年金融危机后，对银行进行第二次救助。")]),t._v(" "),n("li",[t._v("这表示中本聪希望发明一种货币，摆脱传统金融机构的弊端。")])])]),t._v(" "),n("li",[n("p",[t._v("2010 年 5 月，一个美国程序员在 bitcointalk.org 论坛发帖，愿意花费 10000 BTC 换取两个披萨，最后在当地披萨店换取 40 美元左右的披萨。这标志着 BTC 首次兑换实物。")])]),t._v(" "),n("li",[n("p",[t._v("2010 年 8 月，有人利用 BTC 协议的一个严重漏洞，在一次交易中向两个地址分别发送了 900 多亿 BTC 。")]),t._v(" "),n("ul",[n("li",[t._v("该漏洞是因为 BTC 代码没有考虑到交易输出值过大的情况，以至于求和值溢出。")]),t._v(" "),n("li",[t._v("发现区块中打包了这个错误交易之后，Bitcore 开发者在几个小时之后升级了代码，通过软分叉拒绝这种错误交易。这引发了网络分叉，新区块链很快超过了旧区块链的长度。")])])]),t._v(" "),n("li",[n("p",[t._v("2011 年 2 月，BTC 单价达到 1 美元，区块高度达到 10w ，已开采 500w 个 BTC ，全网算力达到 10 GHash/s 。")])]),t._v(" "),n("li",[n("p",[t._v("2011 年 4 月，中本聪向 Bitcoin Core 一个开发者发送了一封电子邮件作为告别，从此从互联网消失。")])]),t._v(" "),n("li",[n("p",[t._v("2011 年 6 月，日本交易所 Mt.Gox 的用户数据库被泄露，导致几百个弱密码哈希的用户被盗号，总共损失 25000 BTC 。几天之后又被黑客登录了一个管理员账户，提取了 2000 BTC 。")]),t._v(" "),n("ul",[n("li",[t._v("2013 年，Mt.Gox 成为全球最大交易所，交易量占全球 70% 。")]),t._v(" "),n("li",[t._v("2014 年，Mt.Gox 突然申请破产保护，停止交易、提币，宣称过去几年累计丢失了 85w BTC 。不确定是黑客攻击还是监守自盗。")])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);