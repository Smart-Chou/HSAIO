(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{748:function(s,t,a){"use strict";a.r(t);var n=a(1),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"ftp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ftp"}},[s._v("#")]),s._v(" FTP")]),s._v(" "),a("p",[s._v("：文件传输协议（File Transfer Protocol）")]),s._v(" "),a("ul",[a("li",[s._v("于 1971 年发布，是一个陈旧、低效、不安全的传输协议。")]),s._v(" "),a("li",[s._v("采用 C/S 架构。\n"),a("ul",[a("li",[s._v("FTP 客户端可以从 FTP 服务器下载文件，或者上传文件到 FTP 服务器。")])])]),s._v(" "),a("li",[s._v("采用明文传输数据，容易被监听。")])]),s._v(" "),a("h2",{attrs:{id:"ftp-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ftp-2"}},[s._v("#")]),s._v(" ftp")]),s._v(" "),a("p",[s._v("：一个命令行工具，用作 FTP 客户端。")]),s._v(" "),a("ul",[a("li",[s._v("安装："),a("code",[s._v("yum install ftp")])]),s._v(" "),a("li",[s._v("通信时，客户端先使用本机随机一个端口创建 Socket ，连接到服务器的 21 端口。登录成功之后有两种通信模式：\n"),a("ul",[a("li",[s._v("主动模式（Acitve mode）\n"),a("ol",[a("li",[s._v("客户端先随机监听一个端口，发送 PORT 命令给服务器。")]),s._v(" "),a("li",[s._v("服务器使用 20 端口连接到客户端的该端口，进行通信。")])]),s._v(" "),a("ul",[a("li",[s._v("服务器的防火墙只需要开通一个端口，但客户端的防火墙需要开通一组可能监听的端口。")])])]),s._v(" "),a("li",[s._v("被动模式（Passive mode）\n"),a("ol",[a("li",[s._v("客户端发送 PASV 命令给服务器。")]),s._v(" "),a("li",[s._v("服务器随机监听一个端口。")]),s._v(" "),a("li",[s._v("客户端连接到服务器的该端口，进行通信。")])]),s._v(" "),a("ul",[a("li",[s._v("客户端的防火墙不需要开通端口，但服务器的防火墙需要开通 21 端口和一组可能监听的端口，比如 21000~21100 。")]),s._v(" "),a("li",[s._v("客户端通常采用被动模式。")])])])])]),s._v(" "),a("li",[s._v("客户端不会保持 TCP 连接，每次执行指令都会根据通信模式重新建立连接。")])]),s._v(" "),a("h3",{attrs:{id:"用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用法"}},[s._v("#")]),s._v(" 用法")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("打开客户端：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ftp")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("host"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("port"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 连接一个 FTP 服务器（这会进入 FTP 客户端的终端）")]),s._v("\n    -A              "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 采用主动模式")]),s._v("\n    -p              "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 采用被动模式（默认）")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("进入 FTP 客户端之后可以执行以下命令：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("host"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 连接服务器")]),s._v("\nclose         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 断开服务器")]),s._v("\nbye           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭客户端")]),s._v("\n\nstatus        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示状态信息")]),s._v("\nascii         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 切换到 ASCII 码传输模式，可能会乱码")]),s._v("\nbinary        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 切换到二进制传输模式")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("ls           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在本地执行 Shell 命令")]),s._v("\nlcd "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("dir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 改变本地的工作目录")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示目录下的文件列表")]),s._v("\ndelete  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("dir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("                 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rmdir")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("dir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("                 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除目录（只能是空目录）")]),s._v("\nget     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("local_file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载文件，保存到本地指定路径")]),s._v("\nput     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("local_file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上传文件，保存到服务器上指定路径")]),s._v("\n\nprompt        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启或关闭交互模式。在同时操作多个文件时，每个文件都询问一次")]),s._v("\nmls           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 同时操作多个文件，且支持使用通配符")]),s._v("\nmdelete\nmget\nmput\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示帮助信息")]),s._v("\ndebug         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启或关闭调试模式")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#例"}},[s._v("#")]),s._v(" 例")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("连接 ftp 服务器：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@CentOS ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ftp")]),s._v("\nftp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.1\nConnected to "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("220")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vsFTPd "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.0")]),s._v(".2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nName "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.1:root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": ftpuser         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输入用户名")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("331")]),s._v(" Please specify the password.\nPassword:                             "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输入密码")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("230")]),s._v(" Login successful.\nRemote system "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v(" is UNIX.\nUsing binary mode to transfer files.\nftp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -al\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("227")]),s._v(" Entering Passive Mode "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10,0")]),s._v(",0,1,208,236"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可见服务器的 IP 是 10.0.0.1 ，端口号是 208*256+236 ，因为每个字段采用 256 进制")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("150")]),s._v(" Here comes the directory listing.\ndrwx------    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("112")]),s._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":50 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\ndrwx------    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("112")]),s._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":50 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n-rw-r--r--    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),s._v("           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("59")]),s._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" 09:33 ftptest.txt\n-rw-r--r--    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),s._v("           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("59")]),s._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" 09:24 tmp.txt\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("226")]),s._v(" Directory send OK.\nftp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("pwd")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("257")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/"')]),s._v("\nftp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /tmp\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("550")]),s._v(" Failed to change directory.     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 无权切换到其它目录")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("下载单个文件：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("ftp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" get tmp.txt\nlocal: tmp.txt remote: tmp.txt\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("227")]),s._v(" Entering Passive Mode "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10,0")]),s._v(",0,1,191,105"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("150")]),s._v(" Opening BINARY mode data connection "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" tmp.txt "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("59")]),s._v(" bytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("226")]),s._v(" Transfer complete.\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("59")]),s._v(" bytes received "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.000218")]),s._v(" secs "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("270.64")]),s._v(" Kbytes/sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nftp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("ls\ntmp.txt\nftp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("cat tmp.txt\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20201211")]),s._v(", 0915, zd_data, tmp.txt, just "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" connection.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("下载多个文件：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("ftp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" prompt                         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭交互模式，否则执行 mget 时会询问每个文件是否下载")]),s._v("\nInteractive mode off.\nftp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mget *.txt\nlocal: ftptest.txt remote: ftptest.txt\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("227")]),s._v(" Entering Passive Mode "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.1,161,64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("150")]),s._v(" Opening BINARY mode data connection "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" ftptest.txt "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("59")]),s._v(" bytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("226")]),s._v(" Transfer complete.\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("59")]),s._v(" bytes received "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.000263")]),s._v(" secs "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("224.33")]),s._v(" Kbytes/sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nlocal: tmp.txt remote: tmp.txt\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("227")]),s._v(" Entering Passive Mode "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.1,184,27"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("150")]),s._v(" Opening BINARY mode data connection "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" tmp.txt "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("59")]),s._v(" bytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("226")]),s._v(" Transfer complete.\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("59")]),s._v(" bytes received "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.000201")]),s._v(" secs "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("293.53")]),s._v(" Kbytes/sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])])])]),s._v(" "),a("h2",{attrs:{id:"vsftpd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vsftpd"}},[s._v("#")]),s._v(" vsftpd")]),s._v(" "),a("p",[s._v("：very secure ftp daemon ，一个加密型的 FTP 服务器。")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://security.appspot.com/vsftpd/vsftpd_conf.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("支持三种登录模式：\n"),a("ul",[a("li",[s._v("匿名用户模式：允许任何客户端登录（用户名为 anonymous ，密码为空），最不安全。")]),s._v(" "),a("li",[s._v("本地用户模式：通过 FTP 服务器所在主机的 SSH 账号登录，不够安全。")]),s._v(" "),a("li",[s._v("虚拟用户模式：通过独立的账号登录，安全性最高。")])])])]),s._v(" "),a("h3",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" vsftpd\nsystemctl start vsftpd\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[s._v("#")]),s._v(" 配置")]),s._v(" "),a("p",[s._v("vsftpd 的配置文件是 "),a("code",[s._v("/etc/vsftpd/vsftpd.conf")]),s._v(" ，内容如下：")]),s._v(" "),a("div",{staticClass:"language-ini line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# listen=YES                # 是否以 stand-alone 模式运行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# listen_address=0.0.0.0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# listen_port=21")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ftp_data_port=20")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# connect_from_port_20=NO")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# max_clients=0             # 允许连接的客户端数，设置为 0 则不限制")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# accept_timeout=60         # 使用被动模式连接的客户端的超时时间，单位为秒")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# connect_timeout=60        # 使用主动模式连接的客户端的超时时间")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# port_enable=YES           # 允许客户端采用主动模式通信")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pasv_enable=YES           # 允许客户端采用被动模式通信")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("pasv_min_port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("0             # 被动模式下，服务器监听的最小端口号，设置为 0 则不限制")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("pasv_max_port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("0             # 被动模式下，服务器监听的最大端口号")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("pasv_address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("10.0.0.1       # 被动模式下，服务器的 IP 地址，会让客户端连接到该 IP")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# download_enable=YES       # 允许用户下载文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("write_enable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("YES            # 允许用户写文件")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("chroot_local_user")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("YES                       # 限制用户只能访问主目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("allow_writeable_chroot")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("YES                  # 允许用户写主目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chroot_list_file=/etc/vsftpd.chroot_list")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chroot_list_enable=YES                    # 限制 chroot_list_file 中的用户只能访问主目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# userlist_file=/etc/vsftpd/user_list       # 黑名单文件，每行记录一个用户名")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# userlist_enable=YES                       # 拒绝 userlist_file 名单中的用户登录")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# use_localtime=YES                         # 是否将显示的时间转换到本地时区（默认为 UTC 时区）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("xferlog_enable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("YES                          # 开启日志")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("xferlog_file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/var/log/vsftpd.log            # 日志文件的路径")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br")])]),a("h3",{attrs:{id:"匿名用户模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#匿名用户模式"}},[s._v("#")]),s._v(" 匿名用户模式")]),s._v(" "),a("ol",[a("li",[s._v("在配置文件中加入以下配置："),a("div",{staticClass:"language-ini line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("listen_address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("127.0.0.1      # 只允许本地 IP 访问，否则匿名用户模式很危险")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("anonymous_enable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("YES          # 是否启用匿名用户模式（默认启用）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("anon-upload_enable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("YES        # 允许匿名用户上传文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("anon-umask")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("022                # 匿名用户上传的文件的 umask 值")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("anon_root")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/var/ftp            # 匿名用户的主目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("anon_mkdir_write_enable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("YES   # 允许匿名用户创建目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("anon_other_write_enable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("YES   # 允许匿名用户修改目录名、删除目录")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("ul",[a("li",[s._v("配置文件语法：\n"),a("ul",[a("li",[s._v("等号 = 前后不能有空格。")]),s._v(" "),a("li",[s._v("用 YES、NO 表示布尔值。")])])]),s._v(" "),a("li",[s._v("修改配置文件之后，要重启服务才能生效："),a("code",[s._v("systemctl restart vsftpd")])])])])]),s._v(" "),a("h3",{attrs:{id:"虚拟用户模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#虚拟用户模式"}},[s._v("#")]),s._v(" 虚拟用户模式")]),s._v(" "),a("p",[s._v("这里是同时启用本地用户模式、虚拟用户模式，通过本地 SSH 用户的 PAM 模块完成虚拟用户的身份认证。")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("在配置文件中加入以下配置：")]),s._v(" "),a("div",{staticClass:"language-ini line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("anonymous_enable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("NO")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("local_enable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("YES                        # 启用本地用户模式")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("guest_enable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("YES                        # 启用虚拟用户模式")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("virtual_use_local_privs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("YES             # 让虚拟用户拥有与本地用户相同的权限（默认只拥有匿名用户的权限）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("pam_service_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("vsftpd.vu              # 采用指定的 PAM 配置文件进行身份认证")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("user_config_dir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/etc/vsftpd/users_conf  # 读取用户配置的目录")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("为每个虚拟用户单独创建配置文件：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /etc/vsftpd/users_conf/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/vsftpd/users_conf/ftpuser\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-ini line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("guest_username")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("ftpuser")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("local_root")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/home/ftpuser    # 本地用户登录之后进入的目录，这里采用用户的家目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# local_umask=077")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("为每个虚拟用户创建一个同名的 SSH 用户，以便通过 PAM 模块进行身份认证：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" ftpuser -s /sbin/nologin\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("创建一个临时的 users 文件，配置虚拟用户名和密码：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("ftpuser\nFnwKhwCWBo90\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ftpuser2        # 可以配置多个用户")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# XJo4lfLkJZX3")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("然后将密码文件转换成加密数据库：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y libdb-utils\ndb_load -T -t "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("hash")]),s._v(" -f "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("users")]),s._v(" /etc/vsftpd/users.db\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("600")]),s._v(" /etc/vsftpd/users.db\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("users")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("创建一个 PAM 的配置文件 /etc/pam.d/vsftpd.vu ，根据加密数据库验证用户身份：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("auth      required pam_userdb.so  "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("db")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/vsftpd/users\naccount   required pam_userdb.so  "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("db")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/vsftpd/users\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])])])])}),[],!1,null,null,null);t.default=e.exports}}]);