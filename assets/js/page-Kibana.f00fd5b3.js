(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{549:function(s,a,t){s.exports=t.p+"assets/img/kibana_discover.d1e239b3.png"},625:function(s,a,t){"use strict";t.r(a);var n=t(1),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"kibana"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#kibana"}},[s._v("#")]),s._v(" Kibana")]),s._v(" "),n("h2",{attrs:{id:"部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#部署"}},[s._v("#")]),s._v(" 部署")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("下载二进制版：")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://artifacts.elastic.co/downloads/kibana/kibana-7.10.0-linux-x86_64.tar.gz\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("解压后，编辑配置文件 config/kibana.yml ：")]),s._v(" "),n("div",{staticClass:"language-yml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server.port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5601")]),s._v("           "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Kibana 监听的端口")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server.host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'0.0.0.0'")]),s._v("      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Kibana 监听的 IP")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server.name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kibana         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务器显示的名称")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("elasticsearch.hosts")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://10.0.0.1:9200'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要连接的 ES 地址。可以指定多个 host ，但必须属于同一集群，如果前一个不能访问则使用后一个")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# elasticsearch.username: 'admin'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# elasticsearch.password: '123456'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kibana.index: '.kibana'   # 在 ES 中创建该索引，存储 Kibana 的数据")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("i18n.locale")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'zh-CN'")]),s._v("        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 让 Kibana 网站显示中文")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("ul",[n("li",[s._v("如果 ES 集群包含多个节点，为了对 Kibana 发向 ES 的查询请求进行负载均衡，建议在 Kibana 所在主机上部署一个 ES 节点，只担任 coordinating 角色，然后让 Kibana 将查询请求都发给它。")])])]),s._v(" "),n("li",[n("p",[s._v("启动：")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("bin/kibana\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])])]),s._v(" "),n("h2",{attrs:{id:"用法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#用法"}},[s._v("#")]),s._v(" 用法")]),s._v(" "),n("ul",[n("li",[s._v("Kibana 的主要功能：\n"),n("ul",[n("li",[s._v("查询 ES 中的数据，并可以创建仪表盘，便于分析。")]),s._v(" "),n("li",[s._v("管理 ES 的索引，进行多种配置。")]),s._v(" "),n("li",[s._v("支持在网页上上传日志文件，解析后存储到 ES ，便于测试。")])])]),s._v(" "),n("li",[s._v("访问 URL "),n("code",[s._v("/status")]),s._v(" 可查看 Kibana 自身的状态。")]),s._v(" "),n("li",[s._v("Kibana 会将自身的数据存储在 ES 中名为 .kibana 的索引中。")]),s._v(" "),n("li",[s._v("Kibana 网站是单页面应用，但是加载网页时很慢，刷新首页都需要 5 秒。")]),s._v(" "),n("li",[s._v("建议在 Kibana 网站上进行以下设置：\n"),n("ul",[n("li",[s._v("设置 Default 工作区，只显示 Kibana、Observability 中需要用到的部分功能。")]),s._v(" "),n("li",[s._v("Date format ：显示的日期格式，比如 "),n("code",[s._v("YYYY/MM/D HH:mm:ss.SSS")]),s._v(" 。")]),s._v(" "),n("li",[s._v("defaultRoute ：Kibana 网站登录之后默认跳转的页面，比如 "),n("code",[s._v("/app/discover")]),s._v(" 。")]),s._v(" "),n("li",[s._v("Maximum table cell height ：Discover 页面每个文档显示的最大高度。建议设置为 0 ，即取消限制。否则一个文档包含的内容过长时，可能显示不全。")]),s._v(" "),n("li",[s._v("Number of rows ：Discover 页面查询时返回的文档最大数量。\n"),n("ul",[n("li",[s._v("默认值为 500 ，减小该值可以降低查询的耗时，特别是每个文档体积较大时。")]),s._v(" "),n("li",[s._v("查询到文档之后，会先在浏览器中显示一部分文档。当用户向下翻页时，才动态加载后续的文档，直到显示出查询到的所有文档。")])])])])])]),s._v(" "),n("h3",{attrs:{id:"discover"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#discover"}},[s._v("#")]),s._v(" Discover")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("Kibana 的 Discover 页面原本名为 Logs UI ，用于查询、查看日志。但现在扩展了用途，可对所有 ES 文档进行可视化查询。")])]),s._v(" "),n("li",[n("p",[s._v("页面示例：")]),s._v(" "),n("p",[n("img",{attrs:{src:t(549),alt:"",loading:"lazy"}})]),s._v(" "),n("ul",[n("li",[s._v("页面左上方是搜索栏，支持输入任意字符串进行全文查询，也支持复杂的查询表达式。")]),s._v(" "),n("li",[s._v("页面右上方是时间筛选，支持筛选任意时间范围，或最近一段时间，还支持设置自动刷新的时间间隔。\n"),n("ul",[n("li",[s._v("注意要选择有效的时间范围，否则查询结果可能为空。")])])]),s._v(" "),n("li",[s._v("页面左侧可选择索引模式、显示的字段。\n"),n("ul",[n("li",[s._v("需要事先在 Kibana 管理页面创建 index pattern ，且字段列表变化时，需要手动点击刷新按钮。")])])]),s._v(" "),n("li",[s._v("页面中央是一个时间轴，显示每个时刻命中的 document 数量。")]),s._v(" "),n("li",[s._v("页面中下方是一个列表，显示所有查询结果。\n"),n("ul",[n("li",[s._v("每行一条 document ，点击某个 document 左侧的下拉按钮，就会显示其详细信息。")]),s._v(" "),n("li",[s._v("默认显示 Time 和 _source 字段，可以在左侧栏中指定其它字段用作显示。")])])]),s._v(" "),n("li",[s._v("点击搜索栏前端的保存按钮，可以保存当前的 query 配置，包括查询表达式、字段筛选、时间筛选。")]),s._v(" "),n("li",[s._v("点击页面右上角的 Save 按钮，可以会保存当前的搜索页面，包括查询表达式、字段筛选、显示的字段，但不包括时间筛选。")])])]),s._v(" "),n("li",[n("p",[s._v("搜索时，默认采用 Kibana 自带的查询语言 KQL 。")]),s._v(" "),n("ul",[n("li",[s._v("例："),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("elastic                   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询任一字段的值包含该单词的文档。必须是分词之后完全相同的单词，比如 elasticsearch 多了字母就不匹配")]),s._v("\nelastic*                  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以使用通配符")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"elastic search"')]),s._v("          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询一个包含空格的字符串时，需要加上定界符")]),s._v("\nelastic AND NOT search    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 支持使用 and、or、not 逻辑运算符")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])])]),s._v(" "),n("li",[s._v("支持用 "),n("code",[s._v(":")]),s._v(" 对指定字段进行查询："),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("agent_* "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filebeat-00*"')]),s._v("            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 支持在字段名、值中使用通配符")]),s._v("\nagent_name: *                       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# agent_name 字段存在")]),s._v("\nNOT agent_name: *                   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# agent_name 字段不存在")]),s._v("\nstatus_code "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("401")]),s._v(" OR "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("403")]),s._v(" OR "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("404")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nstatus_code "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v(" AND NOT "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tags "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("success AND info"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])])]),s._v(" "),n("li",[s._v("点击页面右上角的 Inspect ，可以查看查询的耗时、对应的 query 语句。")])])])]),s._v(" "),n("h3",{attrs:{id:"fleet"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#fleet"}},[s._v("#")]),s._v(" Fleet")]),s._v(" "),n("ul",[n("li",[s._v("Kibana 的 Fleet 页面原本名为 Ingest Manager ，用于批量管理 Elastic Agent 。")])])])}),[],!1,null,null,null);a.default=e.exports}}]);