(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{579:function(s,a,e){s.exports=e.p+"assets/img/LDAP_2.343d3266.png"},580:function(s,a,e){s.exports=e.p+"assets/img/LDAP_3.789625ab.png"},879:function(s,a,e){"use strict";e.r(a);var n=e(1),t=Object(n.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"ldap-admin"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ldap-admin"}},[s._v("#")]),s._v(" Ldap Admin")]),s._v(" "),n("p",[s._v("：一个用作 LDAP 客户端的 GUI 软件，运行在 Windows 上，无需安装。")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://ldapadmin.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("它会将连接服务器的凭据以明文形式保存在 Windows 的注册表中。")])]),s._v(" "),n("h2",{attrs:{id:"用法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#用法"}},[s._v("#")]),s._v(" 用法")]),s._v(" "),n("p",[s._v("打开软件之后，先连接到服务器，配置示例如下：")]),s._v(" "),n("p",[n("img",{attrs:{src:e(579),alt:"",loading:"lazy"}})]),s._v(" "),n("p",[s._v("连接成功之后，会显示查询到的条目。可以在 GUI 界面中新增、编辑条目。如下：")]),s._v(" "),n("p",[n("img",{attrs:{src:e(580),alt:"",loading:"lazy"}})]),s._v(" "),n("h2",{attrs:{id:"对接-jenkins-的示例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#对接-jenkins-的示例"}},[s._v("#")]),s._v(" 对接 Jenkins 的示例")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("在 LDAP 中创建用户、用户组。如下：")]),s._v(" "),n("div",{staticClass:"language-ini line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ini"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 根节点")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("dn: dc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("example,dc=org")]),s._v("\nobjectClass: top\nobjectClass: dcObject\nobjectClass: organization\no: Example Inc.\ndc: example\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在该节点的目录之下创建用户")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("dn: ou")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("people,dc=example,dc=org")]),s._v("\nou: people\nobjectClass: organizationalUnit\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在该节点的目录之下创建用户组")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("dn: ou")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("groups,dc=example,dc=org")]),s._v("\nou: groups\nobjectClass: organizationalUnit\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义一个表示用户的条目")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("dn: uid")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("leo,ou=people,dc=example,dc=org")]),s._v("\nobjectClass: person\nobjectClass: uidObject\nobjectClass: mailAccount\nuserPassword: {CRYPT}$5$UMEVzYGr$cl9AXM/RKRC9xIt08JVlyI3TQiqXQHVHJTQ8KTtgfP/    # 该示例中设置密码为 123456 ，采用 SHA-256 加密算法\nmail: 123456@qq.com\ncn: Leo                   # 可以存储中文名，用于显示\nsn: Leo                   # 姓氏\nuid: leo                  # 用于存储英文名，用于登录\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义一个表示用户的条目")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("dn: uid")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("will,ou=people,dc=example,dc=org")]),s._v("\nobjectClass: person\nobjectClass: uidObject\nobjectClass: mailAccount\nuserPassword: {CRYPT}$5$UMEVzYGr$cl9AXM/RKRC9xIt08JVlyI3TQiqXQHVHJTQ8KTtgfP/\nmail: 123456@qq.com\ncn: Will\nsn: Will\nuid: will\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义一个表示用户组的条目")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("dn: cn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("viewer,ou=groups,dc=example,dc=org")]),s._v("\nobjectClass: groupOfNames\ncn: viewer\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("member: uid")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("leo,ou=people,dc=example,dc=org")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("member: uid")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("will,ou=people,dc=example,dc=org")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义一个表示用户组的条目")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("dn: cn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("admin,ou=groups,dc=example,dc=org")]),s._v("\nobjectClass: groupOfNames\ncn: admin\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("member: uid")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("leo,ou=people,dc=example,dc=org")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br")])]),n("ul",[n("li",[s._v("每个用户组可以声明多个 member 属性，每个 member 属性的值为某个条目的 dn ，表示成员关系。")])])]),s._v(" "),n("li",[n("p",[s._v("进入 Jenkins 的 "),n("code",[s._v("Configure Global Security")]),s._v(" 页面，启用 LDAP 认证，配置如下：")]),s._v(" "),n("div",{staticClass:"language-ini line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ini"}},[n("code",[s._v("Server                          ldap://10.0.0.1:389\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("root DN                         dc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("example,dc=org                           # 查询的起点，越准确越能减少查询耗时")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("User search base                ou")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("people                                   # 到哪个目录之下查询用户")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("User search filter              uid")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("{0}                                     # 查询用户的表达式，这里的 {0} 会被 Jenkins 替换成具体的登录名，改成 mail{0} 就是用邮箱作为登录名")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("Group search base               ou")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("groups                                   # 到哪个目录之下查询用户组")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("Group search filter             (& (cn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("{0}) (objectclass=groupOfNames))     # 查询用户组的表达式")]),s._v("\nGroup membership                Search for LDAP groups containing user      # 识别用户组的策略，这里是根据 member 属性判断用户组\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("Manager DN                      cn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("root,dc=example,dc=org                   # 登录 LDAP 服务器的账号")]),s._v("\nManager Password                ******\nDisplay Name LDAP attribute\t    cn                                          # 用户认证成功之后，显示的用户名称\nEmail Address LDAP attribute    mail                                        # 显示的用户邮箱\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("配置之后可以测试认证一个用户，Jenkins 会显示详细的提示信息，如下：")]),s._v(" "),n("div",{staticClass:"language-ini line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ini"}},[n("code",[s._v("Authentication: successful                    # 认证成功\nUser ID: Leo                                  # 查询到的用户属性\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("User Dn: uid")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("leo,ou=people,dc=example,dc=org")]),s._v("\nUser Display Name: Leo\nUser email: 123456@qq.com\nLDAP Group membership:                        # 查询到包含该用户的的用户组\n  · viewer\n  · admin\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])])])]),s._v(" "),n("ul",[n("li",[n("p",[s._v("认证流程：")]),s._v(" "),n("ol",[n("li",[s._v("用户登录 Jenkins ，输入登录名和密码。")]),s._v(" "),n("li",[s._v("Jenkins 向 LDAP 服务器发出查询请求，在 ou=people 目录下查询与登录名匹配的用户。如果存在则允许登录，否则拒绝登录。")]),s._v(" "),n("li",[s._v("Jenkins 到 ou=groups 目录下查询包含该用户的用户组（可能存在多个）。查询表达式大概如下："),n("div",{staticClass:"language-ini line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ini"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("(& (objectClass")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("groupOfNames) (member=cn=Leo,ou=people,dc=example,dc=org))    # 查询 groupOfNames 类型，且包含指定用户的条目")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("li",[s._v("Jenkins 根据自身的权限策略，判断该用户、用户组应该分配什么权限。")])])]),s._v(" "),n("li",[n("p",[s._v("缺点：")]),s._v(" "),n("ul",[n("li",[s._v("查询到多个同名的用户时可能出错。")]),s._v(" "),n("li",[s._v("新增用户时不能自动加入用户组。\n"),n("ul",[n("li",[s._v("例如：创建一个表示用户组的条目 ou=admin ，在其下创建一个表示用户的条目 cn=Leo 。该用户并不会自动成为该用户组的成员，需要手动给用户组添加 member 属性。")]),s._v(" "),n("li",[s._v("不过删除一个用户时，会自动删除所有用户组中引用它的 member 属性。")])])]),s._v(" "),n("li",[s._v("大部分 LDAP 客户端不支持自动查询嵌套组（nested group），因此定义大量用户组时总是需要逐个加入用户，很麻烦。\n"),n("ul",[n("li",[s._v("嵌套组是指一个用户组是另一个用户组的 member 。")]),s._v(" "),n("li",[s._v("例如：将用户 cn=Leo 声明为用户组 ou=admin 的 member ，将用户组 ou=admin 声明为用户组 ou=viewer 的 member 。大部分客户端只会发现用户 cn=Leo 属于用户组 ou=admin ，不会发现该用户还属于用户组 ou=viewer 。")])])])])])]),s._v(" "),n("h2",{attrs:{id:"ltb-project"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ltb-project"}},[s._v("#")]),s._v(" LTB project")]),s._v(" "),n("p",[s._v("：提供了一些 LDAP 工具。")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://ltb-project.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网"),n("OutboundLink")],1)])]),s._v(" "),n("p",[s._v("常用工具：")]),s._v(" "),n("ul",[n("li",[s._v("Self Service Password\n"),n("ul",[n("li",[s._v("：一个 Web 服务器，采用 PHP 开发。允许用户通过 Web 页面自行修改密码，而不需要 LDAP 管理员修改。")])])]),s._v(" "),n("li",[s._v("White Pages\n"),n("ul",[n("li",[s._v("：一个 Web 服务器，采用 PHP 开发。允许用户搜索、查看 LDAP 中的数据。")])])]),s._v(" "),n("li",[s._v("Service Desk\n"),n("ul",[n("li",[s._v("：一个 Web 服务器，采用 PHP 开发。供 LDAP 管理员锁定、重置用户密码。")])])])])])}),[],!1,null,null,null);a.default=t.exports}}]);