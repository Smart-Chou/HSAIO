(window.webpackJsonp=window.webpackJsonp||[]).push([[272],{1046:function(e,t,n){"use strict";n.r(t);var a=n(1),s=Object(a.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("p",[e._v("WebSocket 通知用于通知浏览器和桌面 Bitwarden 客户端发生了一些感兴趣的事件，例如密码数据库中的条目被修改或删除时。")]),e._v(" "),n("p",[e._v("收到通知后，客户端可以采取适当的操作，例如重新获取修改后的条目，或从其本地数据库副本中删除已删除的条目。")]),e._v(" "),n("p",[e._v("在此通知方案中，Bitwarden 客户端与 Bitwarden 服务器(在本例中为 vaultwarden)建立持久的 WebSocket 连接。")]),e._v(" "),n("p",[e._v("每当服务器有事件要报告时，它就会通过此持久连接将其发送给客户端。")]),e._v(" "),n("p",[e._v("请注意，WebSocket 通知不适用于移动 (Android/iOS) Bitwarden 客户端。这些客户端使用原生推送通知服务 ("),n("a",{attrs:{href:"https://firebase.google.com/docs/cloud-messaging",target:"_blank",rel:"noopener noreferrer"}},[e._v("FCM"),n("OutboundLink")],1),e._v(" for Android，"),n("a",{attrs:{href:"https://developer.apple.com/go/?id=push-notifications",target:"_blank",rel:"noopener noreferrer"}},[e._v("APNs"),n("OutboundLink")],1),e._v(" 适用于 iOS)。 Vaultwarden 目前不支持向移动客户端推送通知。")]),e._v(" "),n("p",[e._v("要启用 WebSockets 通知，需要外部反向代理，并且必须对其进行配置以执行以下操作：")]),e._v(" "),n("ul",[n("li",[e._v("将 "),n("code",[e._v("/notifications/hub")]),e._v(" 端点路由到 WebSocket 服务器，默认在端口 "),n("code",[e._v("3012")]),e._v("，确保传递 "),n("code",[e._v("Connection")]),e._v(" 和 "),n("code",[e._v("Upgrade")]),e._v(" 标头。 (注意端口可以用"),n("code",[e._v("WEBSOCKET_PORT")]),e._v("变量改变)")]),e._v(" "),n("li",[e._v("将其他所有内容(包括"),n("code",[e._v("/notifications/hub/negotiate")]),e._v(")路由到标准 Rocket 服务器，默认在端口"),n("code",[e._v("80")]),e._v("。")]),e._v(" "),n("li",[e._v("如果使用 Docker，您可能需要使用 "),n("code",[e._v("-p")]),e._v(" 标志映射两个端口")])]),e._v(" "),n("p",[e._v("示例配置包含在 "),n("RouterLink",{attrs:{to:"/vaultwarden/Deployment/Proxy-examples.html"}},[e._v("代理示例")]),e._v(" 中。")],1),e._v(" "),n("p",[e._v("然后你需要通过将"),n("code",[e._v("WEBSOCKET_ENABLED")]),e._v("变量设置为"),n("code",[e._v("true")]),e._v("来在Vaultwarden端启用WebSockets协商：")]),e._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" run -d --name vaultwarden "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  -e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("WEBSOCKET_ENABLED")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("true "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  -v /vw-data/:/data/ "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  -p "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("80")]),e._v(":80 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  -p "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("3012")]),e._v(":3012 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  vaultwarden/server:latest\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("p",[e._v("注意：此解决方法的原因是 Rocket 缺乏对 WebSockets 的支持(尽管 "),n("a",{attrs:{href:"https://github.com/SergioBenitez/Rocket/issues/90",target:"_blank",rel:"noopener noreferrer"}},[e._v("这是一个计划中的功能"),n("OutboundLink")],1),e._v(")，这迫使我们启动一个辅助服务器在一个单独的端口上。")])])}),[],!1,null,null,null);t.default=s.exports}}]);