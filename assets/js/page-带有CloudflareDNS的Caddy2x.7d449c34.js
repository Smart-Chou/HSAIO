(window.webpackJsonp=window.webpackJsonp||[]).push([[300],{1082:function(s,n,a){"use strict";a.r(n);var t=a(1),e=Object(t.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("br"),s._v(" "),a("h2",{attrs:{id:"dockerfile-caddy-生成器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile-caddy-生成器"}},[s._v("#")]),s._v(" Dockerfile(Caddy 生成器)")]),s._v(" "),a("div",{staticClass:"language-nginx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[s._v("FROM caddy:builder AS builder\nRUN xcaddy build --with github.com/caddy-dns/cloudflare\n\nFROM caddy:latest\nCOPY --from=builder /usr/bin/caddy /usr/bin/caddy\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"构建命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建命令"}},[s._v("#")]),s._v(" 构建命令")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build -t "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("你的名字"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("/caddycfdns。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"caddyfile-作为反向代理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#caddyfile-作为反向代理"}},[s._v("#")]),s._v(" Caddyfile(作为反向代理)")]),s._v(" "),a("div",{staticClass:"language-nginx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("https://[您的域名]:443")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("tls")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        dns cloudflare [API-KEY]\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("encode")]),s._v(" gzip\n\n   header /")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n       "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启用 HTTP 严格传输安全 (HSTS)")]),s._v('\n        Strict-Transport-Security "max-age=31536000'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v('"\n       '),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启用跨站过滤器 (XSS) 并告诉浏览器阻止检测到的攻击")]),s._v('\n        X-XSS-Protection "1'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(' mode=block"\n       '),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 禁止在框架内渲染站点(点击劫持保护)")]),s._v('\n       X-Frame-Options "DENY"\n       '),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 防止搜索引擎索引(可选)")]),s._v('\n       X-Robots-Tag "none"\n       '),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除服务器名称")]),s._v("\n       -Server\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 协商端点也代理到 Rocket")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("reverse_proxy")]),s._v(" /notifications/hub/negotiate vaultwarden:80\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通知重定向到 websockets 服务器")]),s._v("\n  reverse_proxy /notifications/hub Vaultwarden:3012\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将根目录代理到 Rocket")]),s._v("\n  reverse_proxy Vaultwarden:80")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n       "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将真正的远程IP发送给Rocket，以便Vaultwarden可以将其放入")]),s._v("\n       "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 日志，以便fail2ban 可以禁止正确的IP。")]),s._v("\n       "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("header_up")]),s._v(" X-Real-IP")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("remote_host"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br")])]),a("h3",{attrs:{id:"docker-compose-yml"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-yml"}},[s._v("#")]),s._v(" docker-compose.yml")]),s._v(" "),a("div",{staticClass:"language-nginx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[s._v("version: '3'\n\nservices:\n  vaultwarden:\n    image: vaultwarden/server\n    restart: always\n    volumes:\n      - $PWD/vw-data:/data\n    environment:\n      WEBSOCKET_ENABLED: 'true' "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Required to use websockets")]),s._v("\n      SIGNUPS_ALLOWED: 'false'   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# set to false to disable signups")]),s._v("\n      DOMAIN: 'https://[DOMAIN]'\n      SMTP_HOST: '[MAIL-SERVER]'\n      SMTP_FROM: '[E-MAIL]'\n      SMTP_PORT: '587'\n      SMTP_SSL: 'true'\n      SMTP_USERNAME: '[E-MAIL]'\n      SMTP_PASSWORD: '[SMTP-PASS]'\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#      ADMIN_TOKEN: '[RAND. GENERATE]'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#      YUBICO_CLIENT_ID: '[OPTIONAL]'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#      YUBICO_SECRET_KEY: '[OPTIONAL]'")]),s._v("\n\n  caddy:\n    image: [YOUR-NAME]/caddycfdns\n    restart: always\n    volumes:\n      - $PWD/Caddyfile:/etc/caddy/Caddyfile\n      - caddy_data:/data\n      - caddy_config:/config\n      - caddy_log:/logs\n    ports:\n      - [PRIVATE-IP]:443:443\n    environment:\n      ACME_AGREE: 'true'\n      CLOUDFLARE_EMAIL: '[YOUR-EMAIL]'\n      CLOUDFLARE_API_TOKEN: '[YOUR-TOKEN]'\n      DOMAIN: '[DOMAIN]'\n\nvolumes:\n  caddy_data:\n  caddy_config:\n  caddy_log:\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br")])])])}),[],!1,null,null,null);n.default=e.exports}}]);